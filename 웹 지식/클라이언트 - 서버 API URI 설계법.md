# 클라이언트 - 서버 API URI 설계법

<br>

클라이언트와 서버와의 데이터 통신을 할때 미리 API에 대한 설계를 진행한다.

이때 API의 URI를 네이밍 하는 방법에 대해 알아보자

<br>

## AJAX 메서드

AJAX를 통한 API 데이터 전송 메서드는 크게 5가지가 있다.(더 많지만 실제 사용하는 메서드)

1. GET
2. POST
3. PUT
4. PATCH
5. DELETE

<br>

간단하게 설명을 한다면

### GET

GET은 주로 데이터를 받을때 사용을 한다.

<br>

### POST

payload를 서버에 전달할때 사용한다.

GET을 제외한 나머지 프로세스를 POST로 진행 가능하다.

<br>

### PUT

POST와 비슷하지만 살짝다르게 동작한다.

POST는 payload를 서버에 전달해서 서버에서 해당 payload를 바탕으로 로직을 구성해서 작업을 한다.

<br>

하지만 PUT은 해당 API URI의 데이터를 payload로 전달한 값으로 덮어 씌운다.

따라서 PUT은 payload을 전달하는 목적이 아닌 수정하는 용도로 사용한다.

<br>

### PATCH

PUT이 payload 값을 그대로 덮어버린다고 했다.

하지만 해당 데이터의 일부 프로퍼티만 변경하고 싶다고 할때, PUT으로 데이터를 하나 보내면 모든 데이터를 덮어버리고 그 데이터 하나만 들어간다.

<br>

따라서 이때 PATCH를 사용하면 해당 데이터에 payload 값으로 수정하게 된다.

### DELETE

말 그대로 해당 데이터를 삭제시켜버린다.

<br>

위의 메서드를 공부했으니 URI 설계법에 대해 생각해보자.

<br>

## URI 설계

API 메서드를 사용할때 URI는 어떠한 행위를 적지 않는다.

어떠한 행위를 하는것은 이미 메서드를 통해 파악이 가능하기 때문에 **어떤것에 대한 것인지 명사를 적어주면된다.**

예를들어 회원이라면 /members 와 같이 members만 적어준다.

**괜히 /getMember, /editMember 과 같이 행동인 동사를 적어주면 안된다.**

**회원 조회** : /mem
<br>
bers

- member에 대한 정보를 얻기 위한용도는 GET 메서드를 통해 얻을 수 있다.

**회원 등록 :** /members

- member에 대한 정보를 등록하기 위해 POST를 사용할 수 있다.
- PUT을 사용한다는 것은 해당 회원의 정보를 덮어버리는것이기 때문에 사용불가능하다.

**회원 수정 :** /members/{id}

- POST 메서드를 통해 값을 보내서 그대로 서버쪽에서 payload를 바탕으로 로직을 만들어 수정할 수 있다.
- PUT을 통해서 가능하지만 payload값 자체를 덮어버리기 때문에, 일부 수정하는 것이라면 그 이외의 회원 정보도 같이 담아 보내야 해서 비효율적이다.
- PATCH를 통해서 전달 가능하다. payload의 값으로 회원의 정보 일부분만 수정가능하다.
- PUT과 PATCH는 URI에 정확한 Path가 동시에 들어가야한다.

회원 삭제 : \*\*\*\*/members/{id}

- DELETE 메서드를 통해 회원의 정보를 삭제 가능하다.
- POST 메서드를 통해서도 가능하다. 하지만 해당 URI에 추가적인 Path를 적어주어야한다.
  - ex) \*\*\*\*/members/{id}/delete
  - 위의 예제와 같이 추가적인 path를 적어주어 어떠한 행동을 하는지 적어주는 방법이 있다. 이러한 방법을 **컨트롤 URI** 또는 **컨트롤러** 라고부른다.

<br>

## URI 설계 용어

### document

단일개념으로 조회하거나 보낼때 사용하는 것을 말한다. 따라서 구체적으로 URI를 적어주어야한다.

- ex) 파일 하나, 객체 인스턴스
- /members/100

<br>

### 컬렉션

서버가 관리하는 리소르 디렉토리를 말한다.

서버가 URI를 생성하고 관리도 하는 것을 말한다.

예를들어 회원정보 등록을 할때

- /members POST 메서드를 사용해서 보낸다.

<br>

### 스토어

컬렉션과 반대로 클라이언트가 관리하는 자원 저장소를 말한다.

따라서 클라이언트가 정확한 URI를 알고 관리해야한다.

예를들어 회원정보를 등록할때

- /members/{id} POST 메서드를 사용해서 보낸다.

<br>

컬렉션과 스토어를 비교해보면 어느정도 개념이 들어올것이다.

스토어는 클라이언트가 정확하게 회원정보의 위치를 알고 등록을 하고

컬렉션은 그 상위의 members에 보내기만 하면 서버쪽에서 URI를 등록하고 관리하는 것을 말한다.

<br>

당연히 클라이언트가 미리 URI을 알고있기 힘들다보니 대부분 컬렉션을 통해 이루어진다.

<br>

### 컨트롤러 or 컨트롤 URI

문서, 컬렉션, 스토어로 해결하기 어려운 추가 프로세서를 실행할때 사용한다.

5가지의 메서드만 가지고 프로세스를 URI에 정의하기 힘들때 사용하면된다.

동사를 직접 URI에 넣어서 사용한다.

<br>

예를들어

- /members/{id}/delete
- /members/{id}/edit
- /members/{id}/new
- /members/{id}/upgrade

<br>

참고

- 모든 개발자를 위한 HTTP 웹 기본 지식 인프런 강의
